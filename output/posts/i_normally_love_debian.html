<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-type' />
    <meta content='Tony Pitale' name='author' />
    <meta content='i/cbJtXe1ZDIZNta65CghwcRM/zFMRHIsbR9poU+uwU=' name='verify-v1' />
    <title>t.pitale</title>
    <link href='/favicon.ico' rel='shortcut icon' />
    <link href='http://feeds.feedburner.com/tpitale' rel='alternate' title='Atom feed' type='application/rss+xml' />
    <!-- Site CSS -->
    <link href='/css/base.css' media='screen, projection' rel='stylesheet' type='text/css' />
  </head>
  <body>
    <div id='header'></div>
    <div id='content'>
      <div class='wrap'>
        <div class='col'></div>
        <div class='block'>
          <div id='post'>
            <h1>I Normally Love Debian</h1>
            <h2>As An Application Developer, It Can Hurt</h2>
            <span class='date'>2008-12-06</span>
            <p>
              For whatever reason, I needed to upgrade my apt-get-installed copy of
              Postgresql from 8.1 to 8.3. Now, I can understand why, from a sysadmin
              viewpoint, or from the maintainers view, 8.3 is not as stable as previous
              versions. However, as a user, or as an application developer, 8.3 is a much
              better option. It is also certainly reasonable to want to use the new stuff
              available in a new version. Other system choices enable me to use the
              software I want or need. I've been running 8.3 for months on Mac OS X.
            </p>
            <p>
              On Debian Etch it is generally a good idea to add the backports repository
              to the list of sources for apt to use. This gave me the version of
              Postgresql that I wished to use but, unfortunately, it fails to uninstall
              all of the common libraries for the client and server, as well as the dev
              library (libpq-dev) for the appropriate version. This failure in upgrading
              is due to the ability of Postgres to run multiple versioned "clusters" at
              the same time. I however, uninstalled (without doing --purge, my mistake)
              version 8.1 and installed 8.3 and was not trying to run them together.
            </p>
            <p>
              The reason this caused problems for me was the native postgres gem for ruby
              was compiling itself with the 8.1 headers and so, data_objects and dm-core
              would refuse to connect to 8.3. Especially infuriating was that I could see
              the server running and could connect with the psql client using the same
              connection information I was providing to DataMapper.
            </p>
            <p>
              The solution was to uninstall everything postgresql related using apt and
              the --purge flag. Taking special care to include libpq4 and libpq-dev in
              that list. Uninstall the postgres gem, as well (and possibly data_objects
              and dm-core).
            </p>
            <p>
              Now add "deb http://www.backports.org/debian etch-backports main contrib
              non-free" into /etc/apt/sources.list and do sudo apt-get update to pull the
              list of packages. Now reinstall postgresql-8.3, libpq5, and libpq-dev and
              be sure to pass the -t etch-backports option so that all the required libs
              get pulled from that repository.
            </p>
            <p>
              Finish up by reinstalling all the required gems and all should be well.
              Note that my experience here is not typical, and in general, being strict
              about package stability is generally a good cause. However, it is a very
              useful to have backports available when needed and the packages there are
              generally more stable than other random repositories.
            </p>
            <div id='disqus_thread'></div>
          </div>
          <script src='http://disqus.com/forums/tpitale/embed.js' type='text/javascript'></script>
          <noscript>
            <a href='http://tpitale.disqus.com/?url=ref'>
              View the discussion thread.
            </a>
            <a class='dsq-brlink' href='http://disqus.com'>
              blog comments powered by
              <span class='logo-disqus'>
                Disqus
              </span>
            </a>
          </noscript>
        </div>
      </div>
    </div>
    <!-- Google -->
    <script type='text/javascript'>
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type='text/javascript'>
      var pageTracker = _gat._getTracker("UA-3879168-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>
  </body>
</html>
